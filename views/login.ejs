<link rel="stylesheet" text="text/css" href="/stylesheets/bootstrap.min.css" media="all" title="no title">
<link rel="stylesheet" text="text/css" href="/stylesheets/application.css" media="all" title="no title">
<link rel="stylesheet" text="text/css" href="/stylesheets/login.css" media="all" title="no title">
<div class="container-fluid navbar">
  <a class="link-normal" href="/"><h3>LanyardBlue</h3></a>
</div>
<script>
  function generateId(){
    var result = [];
    for(var i = 0; i < 15; i++){
      result.push(Math.floor(Math.random()*100));
    }
    return result.join("-")
  }
</script>

<div class="container-fluid">
  <div class="row login-row">

    <h2>Login or Signup</h2>
    <br/>
    <div class="form-holder">
      <div class="btn-holder">
        <button id="switch-login" class="btn login-button">Login</button>
        <button id="switch-signup" class="btn login-button inactive">Signup</button>
      </div>


      <form id="log-in-form">
        <label>
          Email
          <input type="text" name="user[email]" readonly onfocus="this.removeAttribute('readonly');"/>
        </label>
        <br/>
        <label>
          Password
          <input type="password" name="user[password]" readonly onfocus="this.removeAttribute('readonly');"/>
        </label>
        <br/>
        <input id="login" type="submit" value="submit">
        <input id="demo-button" type="submit" value="try a demo">
      </form>

      <form id="sign-up-form">
        <label>
          Email
          <input type="text" name="user[email]" readonly onfocus="this.removeAttribute('readonly');"/>
        </label>
        <br/>
        <label>
          Username
          <input type="text" name="user[username]" readonly onfocus="this.removeAttribute('readonly');"/>
        </label>
        <br/>
        <label>
          Password
          <input type="password" name="user[password]" readonly onfocus="this.removeAttribute('readonly');"/>
        </label>
        <br/>
        <label>
          Confirm Password
          <input type="password" name="user[confirm_password]" readonly onfocus="this.removeAttribute('readonly');"/>
        </label>
        <br/>
        <input type="submit" value="submit"/>
      </form>

    </div>

  </div>
</div>



<script src="/javascripts/jquery-3.1.1.min.js"></script>
<script>
  $('input').attr('autocomplete','false');
  $("#switch-login").on("click", function(){
    $("#log-in-form").css("display", "block");
    $("#switch-login").removeClass("inactive");
    $("#sign-up-form").css("display", "none");
    $("#switch-signup").addClass("inactive");
  })
  $("#switch-signup").on("click", function(){
    $("#log-in-form").css("display", "none");
    $("#switch-login").addClass("inactive");
    $("#sign-up-form").css("display", "block");
    $("#switch-signup").removeClass("inactive");
  })
</script>
<script src="/javascripts/jquery.matchHeight.js" type="text/javascript"></script>
<script src="/javascripts/bundle.js"></script>
<script>
  var addError = function(err){
    console.log(err);
  };

  $("#log-in-form").on("submit", function(e){
    e.preventDefault();
    var data = $(e.currentTarget).serializeArray();

    $.ajax({
      url: "/api/session/new",
      method: "POST",
      dataType: "json",
      contentType: "application/json",
      data: JSON.stringify({
        "email": data[0].value,
        "password": data[1].value,
      }),

      success: function(response){
        window.location = "/dashboard";
      },

      error: function(response){
        addError("not successful");
      }
    });
  })

  $("#sign-up-form").on("submit", function(e){
    e.preventDefault();
    var data = $(e.currentTarget).serializeArray();
    if(data[2].value != data[3].value){
      addError("password must match");
      return 1;
    }

    $.ajax({
      url: "/api/users/new",
      method: "POST",
      dataType: "json",
      contentType: "application/json",
      data: JSON.stringify({
        "email": data[0].value,
        "username": data[1].value,
        "password": data[2].value,
      }),

      success: function(response){
        window.location = "/dashboard";
      },

      error: function(response){
        addError("not successful")
      }
    });
  })
</script>
