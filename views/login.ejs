<link rel="stylesheet" text="text/css" href="/stylesheets/bootstrap.min.css" media="all" title="no title">
<link rel="stylesheet" text="text/css" href="/stylesheets/application.css" media="all" title="no title">

<div class="container-fluid navbar">
  <a class="link-normal" href="/"><h3>LanyardBlue</h3></a>
</div>

<form id="log-in-form">
  <label>Email</label>
  <input type="text" name="user[email]"/>
  <br/>
  <label>Password</label>
  <input type="password" name="user[password]"/>
  <br/>
  <input type="submit" value="submit">
</form>

<form id="sign-up-form">
  <label>Email</label>
  <input type="text" name="user[email]"/>
  <br/>
  <label>Username</label>
  <input type="text" name="user[username]"/>
  <br/>
  <label>Password
    <input type="password" name="user[password]"/>
  </label>
  <br/>
  <label>Confirm Password</label>
  <input type="password" name="user[confirm_password]"/>
  <br/>
  <input type="submit" value="submit"/>
</form>

<script src="/javascripts/jquery-3.1.1.min.js"></script>
<script src="/javascripts/jquery.matchHeight.js" type="text/javascript"></script>
<script src="/javascripts/bundle.js"></script>
<script>
  var addError = function(err){
    console.log(err);
  };

  $("#log-in-form").on("submit", function(e){
    e.preventDefault();
    var data = $(e.currentTarget).serializeArray();

    $.ajax({
      url: "/api/session/new",
      method: "POST",
      dataType: "json",
      contentType: "application/json",
      data: JSON.stringify({
        "email": data[0].value,
        "password": data[1].value,
      }),

      success: function(response){
        window.location = "/dashboard";
      },

      error: function(response){
        addError("not successful");
      }
    });
  })

  $("#sign-up-form").on("submit", function(e){
    e.preventDefault();
    var data = $(e.currentTarget).serializeArray();
    if(data[2].value != data[3].value){
      addError("password must match");
      return 1;
    }

    $.ajax({
      url: "/api/users/new",
      method: "POST",
      dataType: "json",
      contentType: "application/json",
      data: JSON.stringify({
        "email": data[0].value,
        "username": data[1].value,
        "password": data[2].value,
      }),

      success: function(response){
        window.location = "/dashboard";
      },

      error: function(response){
        addError("not successful")
      }
    });
  })
</script>
